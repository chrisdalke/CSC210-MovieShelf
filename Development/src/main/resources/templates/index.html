<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
    <head th:include="fragments/header :: header">
    </head>
    <body>
        <!-- Include the landing page background image fragment for unauthorized user -->
        <div th:include="fragments/landing-bg :: landing-bg" sec:authorize="isAnonymous()"></div>

        <div class="uk-offcanvas-content uk-light">
            <!-- Include container for ladning page particle effects -->
            <!--<div id="particles-js-index"></div>-->

            <!-- Include the nav fragment -->
            <div th:include="fragments/nav :: nav"></div>

            <!-- Include the sidebar fragment if the user is logged in -->
            <div id="sidebar" class="uk-visible@m" sec:authorize="isAuthenticated()">
                <div th:include="fragments/sidebar :: sidebar">
                </div>
            </div>

            <!-- Landing Page for a not-logged-in user -->
            <div class="main-div uk-padding" sec:authorize="isAnonymous()">
                <h1>Index Page</h1>

                <h2>Not Logged In</h2>
                <h3>Todo: Display a landing page here</h3>
            </div>

            <!-- Landing page for a logged-in user -->
            <div id="main-with-sidebar" class="shelf-bg" sec:authorize="isAuthenticated()">

                <div id="shelf-load-overlay">

                    <div uk-spinner></div> Loading Shelf...
                </div>

                <div th:each="userTitleRow : ${userTitleRows}" th:object="${userTitleRow}">
                    <div class="shelf">
                        <div class="shelf-grid uk-grid-collapse uk-child-width-expand@s" uk-grid>
                            <div th:each="userTitle : ${userTitleRow}" th:object="${userTitle}">
                                <div class="shelf-item-holder"><div class="shelf-item-box"><a th:href="'/titles/'+${userTitle.getTitleId()}">
                                    <div class="movie"> <!-- th:text="${userTitle.getTitleName()}+' ('+${userTitle.getYear()}+')'">-->
                                        <img th:src="${metadataService.getImage(userTitle.getTitleId())}" width="100%" height="100%">
                                    </div>
                                </a></div></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Include the footer fragment -->
            <div th:include="fragments/footer :: footer"></div>

            <script sec:authorize="isAnonymous()" src="/js/particles.min.js"></script>
            <script sec:authorize="isAnonymous()" src="/js/particles-index.js"></script>
            <script sec:authorize="isAuthenticated()" src="/js/shelf.js"></script>
        </div>
    </body>
</html>
